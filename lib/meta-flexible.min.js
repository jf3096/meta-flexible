!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){"use strict";var e=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};!function(n,t,i){function o(e,n){if(!e)throw new Error(B+": "+n)}function r(e,n){e||console.warn(B+": "+n)}function a(){o(!c(),"在使用当前工具库时请勿使用自定义viewpoint meta. viewpoint meta 将会通过当前工具自动计算生成.")}function c(){return t.querySelector('meta[name="viewport"]')}function l(){t.body?t.body.style.fontSize=12*A+"px":t.addEventListener("DOMContentLoaded",l)}function s(e,n){if(!e){var i=c();i?e=i:(e=t.createElement("meta"),e.setAttribute("name","viewport")),e.setAttribute("content",n);var o=k.querySelector("head");if(o)o.appendChild(e);else{var r=t.createElement("div");r.appendChild(e),t.write(r.innerHTML)}}else e.setAttribute("content",n);return e}function u(e){switch(e){case b.TargetDensityDpi:m();break;case b.ScaleRatio:v();break;case b.Rem:d();break;case b.Viewpoint:p();break;default:o(!1,"未知 meta-flexible 方案, plan = "+e)}}function d(){V(1),f()}function p(){V(1),f(!1)}function f(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=void 0,t=x.remResizeDependency,o=x.remUpperResizeLimit,r=x.remRatio,a=x.fixRemManualSettingFontResize;t===E.Width?n=k.clientWidth:t===E.Height?n=k.clientHeight:t===E.Auto||t===E.UseSmallerSize?n=Math.min(k.clientWidth,k.clientHeight):t===E.UseBiggerSize&&(n=Math.max(k.clientWidth,k.clientHeight)),e&&n>o&&(n=o);var c=n/r;a&&(c/=y()),k.style.fontSize=c+"px",i.rem=c}function m(){C()}function v(){var e=w(),n=e/D;n>1&&(n=1),V(n)}function h(){if(A>=2){var e=t.createElement("body"),n=t.createElement("div");n.style.border=".5px solid transparent",e.appendChild(n),k.appendChild(e),1===n.offsetHeight&&k.classList.add("hairlines"),k.removeChild(e)}}function g(e){var n=k.clientWidth;e();var t=k.clientWidth;return w()===D?S.Unknown:t===n?S.No:S.Yes}function w(){return n.screen.width}i.version="0.0.12";var y=function(){var e=void 0,n=function(){return+getComputedStyle(t.documentElement).getPropertyValue("font-size").replace(/px/,"")};return function(){if(!e){var i=t.documentElement.style.cssText;t.documentElement.style.cssText="font-size:100px !important";var o=n();e=o/100,t.documentElement.style.cssText=i}return e}}(),b={TargetDensityDpi:0,ScaleRatio:1,Rem:2,Viewpoint:3},S={Yes:1,No:-1,Unknown:0},E={Width:"width",Height:"height",Auto:"auto",UseBiggerSize:"useBiggerSize",UseSmallerSize:"useSmallerSize"},R=function(e){return e},z={namespace:"meta-flexible",designViewpoint:750,getMetaViewpointTargetDensityDpiContent:function(e,n){return["width="+e,"target-densitydpi=device-dpi","user-scalable=no",n&&"viewport-fit=cover"].filter(Boolean).join(", ")},getMetaViewpointScaleRatioContent:function(e,n){return["width=device-width","initial-scale=1","maximum-scale="+e,"minimum-scale="+e,"user-scalable=no",n&&"viewport-fit=cover"].filter(Boolean).join(", ")},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},plans:[b.TargetDensityDpi,b.ScaleRatio],Plan:b,enableBodyFontSize:!1,enableViewpointFitForIphoneX:!1,remRatio:10,remUpperResizeLimit:540,remResizeDependency:E.Width,client:void 0,disableReportPlanNotWorkingErrorOnce:!0,fixRemManualSettingFontResize:!0,onBeforeApplyPlan:R,applyResponsePlanOnce:!1},x=e({},z,i),M=x.getMetaViewpointTargetDensityDpiContent,T=x.getMetaViewpointScaleRatioContent,P=x.namespace,B=P,D=x.designViewpoint,L=x.enableViewpointFitForIphoneX,k=t.documentElement,A=n.devicePixelRatio||1,C=function(){var e=!1,t=0;return function(){e||(s(void 0,M(D,L)),n.addEventListener("orientationchange",function(){setTimeout(function(){n.innerWidth!==D&&(t++,t>5&&(t=0),s(void 0,M(D+t/1e3,L)))},250)}),e=!0)}}(),V=function(){var e=void 0,n=void 0;return function(t){n!==t&&(n=t,e=s(e,T(t,L)))}}(),W=function(){return function(){var e=P+"所使用的所有方案失效, 暂用最后一种方案兜底";x.disableReportPlanNotWorkingErrorOnce?console.warn(e):setTimeout(function(){return o(!1,e)},0)}}(),F=function(){var e=S.No,n=void 0;return function(){if(x.onBeforeApplyPlan(x),e===S.Yes)return void u(n);if(0===x.plans.length)return e=S.Yes,void u(n);for(;e===S.No;){if(void 0!==x.plans[0]&&(n=x.plans[0]),x.plans.length<=0){W();break}e=g(function(){return u(n)}),e===S.No&&x.plans.shift()}e===S.Unknown&&(e=S.No)}}();!function(){var e=x.enableBodyFontSize;if(!(0,x.isMobile)())return void r(!1,"请确保在移动端下使用"+P);a(),e&&l(),F(),x.applyResponsePlanOnce||n.addEventListener("resize",function(){var e=void 0;return function(){clearTimeout(e),e=setTimeout(F,300)}}()),n.addEventListener("pageshow",function(e){e.persisted&&F()},!1),h(),i.applyResponsePlan=F}()}(window,document,window.__META_FLEXIBLE__=window.__META_FLEXIBLE__||{})});
//# sourceMappingURL=meta-flexible.min.js.map
