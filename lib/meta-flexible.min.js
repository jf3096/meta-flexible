!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){"use strict";var e=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};!function(n,t,i){function o(e,n){if(!e)throw new Error(T+": "+n)}function r(e,n){e||console.warn(T+": "+n)}function a(){o(!c(),"在使用当前工具库时请勿使用自定义viewpoint meta. viewpoint meta 将会通过当前工具自动计算生成.")}function c(){return t.querySelector('meta[name="viewport"]')}function d(){t.body?t.body.style.fontSize=12*V+"px":t.addEventListener("DOMContentLoaded",d)}function u(e,n){if(!e){var i=c();i?e=i:(e=t.createElement("meta"),e.setAttribute("name","viewport")),e.setAttribute("content",n);var o=C.querySelector("head");if(o)o.appendChild(e);else{var r=t.createElement("div");r.appendChild(e),t.write(r.innerHTML)}}else e.setAttribute("content",n);return e}function l(e){switch(e){case g.TargetDensityDpi:v();break;case g.ScaleRatio:m();break;case g.Rem:s();break;case g.Viewpoint:f();break;default:o(!1,"未知 meta-flexible 方案, plan = "+e)}}function s(){O(1),p()}function f(){O(1),p(!1)}function p(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=C.clientWidth;e&&n>B&&(n=B);var t=n/x;C.style.fontSize=t+"px",i.rem=t}function v(){N()}function m(){var e=n.screen.width,t=e/k;t>1&&(t=1),O(t)}function w(){if(V>=2){var e=t.createElement("body"),n=t.createElement("div");n.style.border=".5px solid transparent",e.appendChild(n),C.appendChild(e),1===n.offsetHeight&&C.classList.add("hairlines"),C.removeChild(e)}}function h(e){var n=C.clientWidth;e();var t=C.clientWidth;return b()===k?y.Unknown:t===n?y.No:y.Yes}function b(){return n.screen.width}i.version="0.0.7";var g={TargetDensityDpi:0,ScaleRatio:1,Rem:2,Viewpoint:3},y={Yes:1,No:-1,Unknown:0},E={namespace:"meta-flexible",designViewpoint:750,getMetaViewpointTargetDensityDpiContent:function(e,n){return["width="+e,"target-densitydpi=device-dpi","user-scalable=no",n&&"viewport-fit=cover"].filter(Boolean).join(", ")},getMetaViewpointScaleRatioContent:function(e,n){return["width=device-width","initial-scale=1","maximum-scale="+e,"minimum-scale="+e,"user-scalable=no",n&&"viewport-fit=cover"].filter(Boolean).join(", ")},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},plans:[g.TargetDensityDpi,g.ScaleRatio],Plan:g,enableBodyFontSize:!1,enableViewpointFitForIphoneX:!1,remRatio:10,remUpperResizeLimit:540,client:void 0,disableReportPlanNotWorkingErrorOnce:!0},R=e({},E,i),L=R.getMetaViewpointTargetDensityDpiContent,M=R.getMetaViewpointScaleRatioContent,S=R.namespace,T=S,k=R.designViewpoint,D=R.enableViewpointFitForIphoneX,C=t.documentElement,V=n.devicePixelRatio||1,_=R.plans,x=R.remRatio,B=R.remUpperResizeLimit,F=R.disableReportPlanNotWorkingErrorOnce,N=function(){var e=!1,t=0;return n.addEventListener("orientationchange",function(){setTimeout(function(){n.innerWidth!==k&&(t++,t>5&&(t=0),u(void 0,L(k+t/1e3,D)))},250)}),function(){e||(u(void 0,L(k,D)),e=!0)}}(),O=function(){var e=void 0,n=void 0;return function(t){n!==t&&(n=t,e=u(e,M(t,D)))}}(),P=function(){return function(){var e=S+"所使用的所有方案失效, 暂用最后一种方案兜底";F?console.warn(e):setTimeout(function(){return o(!1,e)},0)}}(),W=function(){var e=void 0,n=y.No,t=void 0;return function(){if(e!==C.clientWidth){if(e=C.clientWidth,n===y.Yes)return void l(t);if(0===_.length)return void l(t);for(;n===y.No;){if(void 0!==_[0]&&(t=_[0]),_.length<=0){P();break}n=h(function(){return l(t)}),n===y.No&&_.shift()}n===y.Unknown&&(n=y.No)}}}();!function(){var e=R.enableBodyFontSize;if(!(0,R.isMobile)())return void r(!1,"请确保在移动端下使用"+S);a(),e&&d(),W(),n.addEventListener("resize",function(){var e=void 0;return function(){clearTimeout(e),e=setTimeout(W,300)}}()),n.addEventListener("pageshow",function(e){e.persisted&&W()},!1),w()}()}(window,document,window.__META_FLEXIBLE__=window.__META_FLEXIBLE__||{})});
//# sourceMappingURL=meta-flexible.min.js.map
