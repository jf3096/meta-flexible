!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";var e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(t,n,i){function o(e,t){if(!e)throw new Error(D+": "+t)}function r(e,t){e||console.warn(D+": "+t)}function a(){o(!c(),"在使用当前工具库时请勿使用自定义viewpoint meta. viewpoint meta 将会通过当前工具自动计算生成.")}function c(){return n.querySelector('meta[name="viewport"]')}function d(){n.body?n.body.style.fontSize=12*_+"px":n.addEventListener("DOMContentLoaded",d)}function u(e,t){if(!e){if(!e){var i=c();i?e=i:(e=n.createElement("meta"),e.setAttribute("name","viewport"))}e.setAttribute("content",t);var o=V.querySelector("head");if(o)o.appendChild(e);else{var r=n.createElement("div");r.appendChild(e),n.write(r.innerHTML)}}else e.setAttribute("content",t);return e}function l(e){switch(e){case y.TargetDensityDpi:v();break;case y.ScaleRatio:m();break;case y.Rem:f();break;case y.Viewpoint:s();break;default:o(!1,"未知 meta-flexible 方案, plan = "+e)}}function f(){z(1),p()}function s(){z(1),p(!1)}function p(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=V.clientWidth;e&&t>B&&(t=B);var n=t/x;V.style.fontSize=n+"px",i.rem=n}function v(){F()}function m(){var e=t.screen.width,n=e/T;n>1&&(n=1),z(n)}function w(){if(_>=2){var e=n.createElement("body"),t=n.createElement("div");t.style.border=".5px solid transparent",e.appendChild(t),V.appendChild(e),1===t.offsetHeight&&V.classList.add("hairlines"),V.removeChild(e)}}function h(e){var t=V.clientWidth;e();var n=V.clientWidth;return b()===T?g.Unknown:n===t?g.No:g.Yes}function b(){return t.screen.width}var y={TargetDensityDpi:0,ScaleRatio:1,Rem:2,Viewpoint:3},g={Yes:1,No:-1,Unknown:0},E={namespace:"meta-flexible",designViewpoint:750,getMetaViewpointTargetDensityDpiContent:function(e,t){return["width="+e,"target-densitydpi=device-dpi","user-scalable=no",t&&"viewport-fit=cover"].filter(Boolean).join(", ")},getMetaViewpointScaleRatioContent:function(e,t){return["width=device-width","initial-scale=1","maximum-scale="+e,"minimum-scale="+e,"user-scalable=no",t&&"viewport-fit=cover"].filter(Boolean).join(", ")},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},plans:[y.TargetDensityDpi,y.ScaleRatio],Plan:y,enableBodyFontSize:!1,enableViewpointFitForIphoneX:!1,remRatio:10,remUpperResizeLimit:540,client:void 0},L=e({},E,i),M=L.getMetaViewpointTargetDensityDpiContent,R=L.getMetaViewpointScaleRatioContent,S=L.namespace,D=S,T=L.designViewpoint,C=L.enableViewpointFitForIphoneX,V=n.documentElement,_=t.devicePixelRatio||1,k=L.plans,x=L.remRatio,B=L.remUpperResizeLimit,F=function(){var e=!1;return function(){e||(u(void 0,M(T,C)),e=!0)}}(),z=function(){var e=void 0,t=void 0;return function(n){t!==n&&(t=n,e=u(e,R(n,C)))}}(),A=function(){return function(){setTimeout(function(){return o(!1,S+"所使用的所有方案失效, 暂用最后一种方案兜底")},0)}}(),N=function(){var e=void 0,t=g.No,n=void 0;return function(){if(e!==V.clientWidth){if(e=V.clientWidth,t===g.Yes)return void l(n);if(0===k.length)return void l(n);for(;t===g.No;){if(void 0!==k[0]&&(n=k[0]),k.length<=0){A();break}t=h(function(){return l(n)}),t===g.No&&k.shift()}t===g.Unknown&&(t=g.No)}}}();!function(){var e=L.enableBodyFontSize;if(!(0,L.isMobile)())return void r(!1,"请确保在移动端下使用"+S);a(),e&&d(),N(),t.addEventListener("resize",function(){var e=void 0;return function(){clearTimeout(e),e=setTimeout(N,300)}}()),t.addEventListener("pageshow",function(e){e.persisted&&N()},!1),w()}()}(window,document,window.__META_FLEXIBLE__=window.__META_FLEXIBLE__||{})});
//# sourceMappingURL=meta-flexible.umd.min.js.map
